var g=r=>{throw TypeError(r)};var f=(r,e,t)=>e.has(r)||g("Cannot "+t);var n=(r,e,t)=>(f(r,e,"read from private field"),t?t.call(r):e.get(r)),l=(r,e,t)=>e.has(r)?g("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),d=(r,e,t,s)=>(f(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),w=(r,e,t)=>(f(r,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const b of a.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&s(b)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();class S{constructor(){this.resetBoard()}resetBoard(){this.board=Array(3).fill(null).map(()=>Array(3).fill(null)),this.round=0,this.timeLine=[]}updateCell(e,t,s){this.round++,this.board[t][e]=s.id,this.timeLine.push({x:e,y:t,playerId:s.id})}removeOldest(){const e=this.timeLine.shift();return this.board[e.y][e.x]=null,e}isCellOccupied(e,t){return this.board[t][e]!==null}checkWinner(){const e=[];for(let t=0;t<3;t++)e.push(this.board[t]),e.push(this.board.map(s=>s[t]));e.push([0,1,2].map(t=>this.board[t][t])),e.push([0,1,2].map(t=>this.board[t][2-t]));for(const t of e)if(t.every(s=>s!==null)){const s=t.reduce((i,a)=>i+a,0);if(s===3)return 1;if(s===30)return 10}return null}}class v{constructor(e,t,s){this.id=e,this.name=t,this.cssClass=s}}class B{constructor(){this.playerInfo=document.getElementById("playerInfo"),this.winDisplay=document.getElementById("win"),this.buttons=document.querySelectorAll(".playgroundButton"),this.playground=document.querySelector(".game"),this.newGameBtn=document.querySelector(".newGame"),this.resetBtn=document.querySelector(".reset")}bindBoard(e){this.buttons.forEach(t=>{t.addEventListener("click",()=>{const s=+t.getAttribute("data-x"),i=+t.getAttribute("data-y");e(s,i,t)})})}bindResetGame(e){this.resetBtn.addEventListener("click",e)}bindStartNewGame(e){this.newGameBtn.addEventListener("click",e)}updateTurnDisplay(e){this.playerInfo.textContent=`${e} ist am Zug`}markCell(e,t){e.classList.add(t)}unmarkCell(e,t,s){const i=document.querySelector(`div[data-x="${e}"][data-y="${t}"]`);i&&i.classList.remove(s)}showWinner(e,t){this.winDisplay.style.display="block",this.winDisplay.textContent=`${e.name} hat gewonnen`,document.querySelectorAll(`.${t.cssClass}`).forEach(s=>s.classList.add("fall-out"))}resetVisuals(){this.buttons.forEach(e=>{e.classList.remove("donut","burger","fall-out")}),this.winDisplay.style.display="none"}show(){this.playground.style.display="block"}hide(){this.playground.style.display="none"}}class I{constructor(){this.modal=document.querySelector(".container.newGameModal"),this.form=this.modal.querySelector("form#createGameForm")}bindNewGame(e){this.form.addEventListener("submit",t=>{t.preventDefault();const s=new FormData(t.target),i=s.get("player1").toString(),a=s.get("player2").toString();i.trim()!==""&&a.trim()!==""&&e(i,a)})}showModal(){this.modal.style.display="block"}hideModal(){this.modal.style.display="none"}}class C{constructor(){this.backgroundItems=document.querySelectorAll(".background li")}showAnimations(){this.backgroundItems.forEach(e=>{e.style.transition="opacity 1.5s ease",e.style.opacity="1"})}hideAnimations(){this.backgroundItems.forEach(e=>{e.style.transition="opacity 1.5s ease",e.style.opacity="0"})}}class E{constructor(){this.sidebar=document.querySelector(".sidebar.gameRules"),this.closeBtn=this.sidebar.querySelector("button.close"),this.openBtn=document.querySelector(".openSidebar")}bindHide(e){this.closeBtn.addEventListener("click",t=>{t.preventDefault(),this.hide(),e()})}bindShow(e){this.openBtn.addEventListener("click",t=>{t.preventDefault(),this.show(),e()})}show(){this.sidebar.classList.add("show")}hide(){this.sidebar.classList.remove("show")}}var o,u,h,c,m,y,p,G,L;class k{constructor(){l(this,p);l(this,o);l(this,u);l(this,h);l(this,c);l(this,m);l(this,y);d(this,o,new B),d(this,h,new I),d(this,u,new C),d(this,c,new E),d(this,m,document.querySelector("main")),d(this,y,document.querySelector("nav")),this.bindUiEvents()}bindUiEvents(){n(this,c).bindShow(w(this,p,G).bind(this)),n(this,c).bindHide(w(this,p,L).bind(this))}bindMoveHandler(e){n(this,o).bindBoard(e)}bindNewGame(e){n(this,h).bindNewGame(e)}updateTurn(e){n(this,o).updateTurnDisplay(e)}markCell(e,t,s){n(this,o).markCell(e,t,s)}unmarkCell(e,t,s){n(this,o).unmarkCell(e,t,s)}showWinner(e,t){n(this,o).showWinner(e,t)}bindRestartGame(e){n(this,o).bindStartNewGame(e)}bindResetGame(e){n(this,o).bindResetGame(e)}resetBoardUI(){n(this,o).resetVisuals()}startNewGame(){this.resetBoardUI(),n(this,o).hide(),n(this,h).showModal(),n(this,u).showAnimations()}showGame(){n(this,h).hideModal(),n(this,u).hideAnimations(),n(this,o).show()}}o=new WeakMap,u=new WeakMap,h=new WeakMap,c=new WeakMap,m=new WeakMap,y=new WeakMap,p=new WeakSet,G=function(){n(this,m).classList.add("blur"),n(this,y).classList.add("blur")},L=function(){n(this,m).classList.remove("blur"),n(this,y).classList.remove("blur")};class q{constructor(){this.ui=new k,this.board=new S,this.buttonList=document.querySelectorAll(".playgroundButton"),this.boundHandleMove=this.handleMove.bind(this),this.initGame(),this.bindEventListener()}initGame(e=null,t=null){const s={player1:sessionStorage.getItem("player1"),player2:sessionStorage.getItem("player2")};s.player1&&s.player2||e&&t?(this.player1=new v(1,s.player1||e,"donut"),this.player2=new v(10,s.player2||t,"burger"),e&&t&&(sessionStorage.setItem("player1",e),sessionStorage.setItem("player2",t)),this.currentPlayer=this.player1,this.ui.updateTurn(this.currentPlayer.name),this.initButtons(),this.ui.showGame()):this.ui.bindNewGame(this.initGame.bind(this))}bindEventListener(){this.ui.bindRestartGame(this.startNewGame.bind(this)),this.ui.bindResetGame(this.resetGame.bind(this))}handleMove(e,t,s){if(this.board.isCellOccupied(e,t))return;this.ui.markCell(s,this.currentPlayer.cssClass),this.board.updateCell(e,t,this.currentPlayer);const i=this.board.checkWinner();if(i){this.showWinner(i),this.disableButtons();return}if(this.board.round>4){const a=this.board.removeOldest(),b=a.playerId===1?this.player1.cssClass:this.player2.cssClass;this.ui.unmarkCell(a.x,a.y,b)}this.switchPlayer(),this.ui.updateTurn(this.currentPlayer.name)}switchPlayer(){this.currentPlayer=this.currentPlayer===this.player1?this.player2:this.player1}showWinner(e){const t=e===1?this.player1:this.player2,s=e===1?this.player2:this.player1;this.ui.showWinner(t,s)}disableButtons(){this.buttonList.forEach(e=>{e.removeEventListener("click",this.boundHandleMove)})}initButtons(){this.ui.bindMoveHandler(this.boundHandleMove)}resetGame(){this.board.resetBoard(),this.ui.resetBoardUI(),this.currentPlayer=this.player1,this.ui.updateTurn(this.currentPlayer.name),this.initButtons()}startNewGame(){sessionStorage.removeItem("player1"),sessionStorage.removeItem("player2"),this.ui.startNewGame(),this.initButtons()}}document.addEventListener("DOMContentLoaded",()=>{new q});
