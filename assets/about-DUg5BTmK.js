import"./main-8ukwXcvQ.js";class d{constructor(){this.resetBoard()}resetBoard(){this.board=Array(3).fill(null).map(()=>Array(3).fill(null)),this.round=0,this.timeLine=[]}updateCell(t,e,s){this.round++,this.board[e][t]=s.id,this.timeLine.push({x:t,y:e,playerId:s.id})}removeOldest(){const t=this.timeLine.shift();return this.board[t.y][t.x]=null,console.log(this.board,t.x,t.y),t}isCellOccupied(t,e){return this.board[e][t]!==null}checkWinner(){const t=[];for(let e=0;e<3;e++)t.push(this.board[e]),t.push(this.board.map(s=>s[e]));t.push([0,1,2].map(e=>this.board[e][e])),t.push([0,1,2].map(e=>this.board[e][2-e]));for(const e of t)if(e.every(s=>s!==null)){const s=e.reduce((r,i)=>r+i,0);if(s===3)return 1;if(s===30)return 10}return null}}class l{constructor(t,e,s){this.id=t,this.name=e,this.cssClass=s}}class c{constructor(){this.board=new d,this.player1=new l(1,sessionStorage.getItem("player1"),"donut"),this.player2=new l(10,sessionStorage.getItem("player2"),"burger"),this.currentPlayer=this.player1,this.buttonList=document.querySelectorAll(".playgroundButton"),this.playerInfo=document.getElementById("playerInfo"),this.winnerDisplay=document.getElementById("win"),this.checkSessionStorage(),this.updatePlayerInfo(),this.initButtons(),document.querySelector(".newGame").addEventListener("click",this.createNewGame),document.querySelector(".reset").addEventListener("click",()=>this.resetGame())}checkSessionStorage(){(!this.player1.name||!this.player2.name)&&history.back()}updatePlayerInfo(){this.playerInfo.textContent=`${this.currentPlayer.name} ist am Zug`}handleMove(t){const e=t.currentTarget,s=parseInt(e.getAttribute("data-x")),r=parseInt(e.getAttribute("data-y"));if(this.board.isCellOccupied(s,r))return;e.classList.add(this.currentPlayer.cssClass),this.board.updateCell(s,r,this.currentPlayer);const i=this.board.checkWinner();if(i){this.showWinner(i),this.disableButtons();return}if(this.board.round>4){const n=this.board.removeOldest(),h=n.playerId===1?this.player1.cssClass:this.player2.cssClass,o=document.querySelector(`div[data-x="${n.x}"][data-y="${n.y}"]`);o&&o.classList.remove(h)}this.switchPlayer(),this.updatePlayerInfo()}switchPlayer(){this.currentPlayer=this.currentPlayer===this.player1?this.player2:this.player1}showWinner(t){const e=t===1?this.player1:this.player2;this.winnerDisplay.style.display="block",this.winnerDisplay.textContent=`${e.name} hat gewonnen`,document.querySelectorAll(`.${e.cssClass}`).forEach(s=>s.classList.add("fall-out"))}disableButtons(){this.buttonList.forEach(t=>{t.removeEventListener("click",this.boundHandleMove)})}initButtons(){this.boundHandleMove=this.handleMove.bind(this),this.buttonList.forEach(t=>{t.addEventListener("click",this.boundHandleMove)})}resetGame(){this.board.resetBoard(),this.buttonList.forEach(t=>{t.classList.remove("donut","burger","fall-out")}),this.currentPlayer=this.player1,this.updatePlayerInfo(),this.winnerDisplay.style.display="none",this.initButtons()}createNewGame(){window.location.href=window.location.origin+"/"}}document.addEventListener("DOMContentLoaded",()=>{new c});
