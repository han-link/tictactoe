var m=r=>{throw TypeError(r)};var y=(r,e,t)=>e.has(r)||m("Cannot "+t);var a=(r,e,t)=>(y(r,e,"read from private field"),t?t.call(r):e.get(r)),u=(r,e,t)=>e.has(r)?m("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),c=(r,e,t,s)=>(y(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();class b{constructor(){this.resetBoard()}resetBoard(){this.board=Array(3).fill(null).map(()=>Array(3).fill(null)),this.round=0,this.timeLine=[]}updateCell(e,t,s){this.round++,this.board[t][e]=s.id,this.timeLine.push({x:e,y:t,playerId:s.id})}removeOldest(){const e=this.timeLine.shift();return this.board[e.y][e.x]=null,e}isCellOccupied(e,t){return this.board[t][e]!==null}checkWinner(){const e=[];for(let t=0;t<3;t++)e.push(this.board[t]),e.push(this.board.map(s=>s[t]));e.push([0,1,2].map(t=>this.board[t][t])),e.push([0,1,2].map(t=>this.board[t][2-t]));for(const t of e)if(t.every(s=>s!==null)){const s=t.reduce((i,n)=>i+n,0);if(s===3)return 1;if(s===30)return 10}return null}}class p{constructor(e,t,s){this.id=e,this.name=t,this.cssClass=s}}class f{constructor(){this.playerInfo=document.getElementById("playerInfo"),this.winDisplay=document.getElementById("win"),this.buttons=document.querySelectorAll(".playgroundButton"),this.playground=document.querySelector(".game"),this.newGameBtn=document.querySelector(".newGame"),this.resetBtn=document.querySelector(".reset")}bindBoard(e){this.buttons.forEach(t=>{t.addEventListener("click",()=>{const s=+t.getAttribute("data-x"),i=+t.getAttribute("data-y");e(s,i,t)})})}bindResetGame(e){this.resetBtn.addEventListener("click",e)}bindStartNewGame(e){this.newGameBtn.addEventListener("click",e)}updateTurnDisplay(e){this.playerInfo.textContent=`${e} ist am Zug`}markCell(e,t){e.classList.add(t)}unmarkCell(e,t,s){const i=document.querySelector(`div[data-x="${e}"][data-y="${t}"]`);i&&i.classList.remove(s)}showWinner(e,t){this.winDisplay.style.display="block",this.winDisplay.textContent=`${e.name} hat gewonnen`,document.querySelectorAll(`.${t.cssClass}`).forEach(s=>s.classList.add("fall-out"))}resetVisuals(){this.buttons.forEach(e=>{e.classList.remove("donut","burger","fall-out")}),this.winDisplay.style.display="none"}show(){this.playground.style.display="block"}hide(){this.playground.style.display="none"}}class w{constructor(){this.modal=document.querySelector(".container.newGameModal"),this.form=this.modal.querySelector("form#createGameForm")}bindNewGame(e){this.form.addEventListener("submit",t=>{t.preventDefault();const s=new FormData(t.target),i=s.get("player1").toString(),n=s.get("player2").toString();i.trim()!==""&&n.trim()!==""&&e(i,n)})}showModal(){this.modal.style.display="block"}hideModal(){this.modal.style.display="none"}}class g{constructor(){this.backgroundItems=document.querySelectorAll(".background li")}showAnimations(){this.backgroundItems.forEach(e=>{e.style.transition="opacity 1.5s ease",e.style.opacity="1"})}hideAnimations(){this.backgroundItems.forEach(e=>{e.style.transition="opacity 1.5s ease",e.style.opacity="0"})}}var o,d,l;class G{constructor(){u(this,o);u(this,d);u(this,l);c(this,o,new f),c(this,l,new w),c(this,d,new g)}bindMoveHandler(e){a(this,o).bindBoard(e)}bindNewGame(e){a(this,l).bindNewGame(e)}updateTurn(e){a(this,o).updateTurnDisplay(e)}markCell(e,t,s){a(this,o).markCell(e,t,s)}unmarkCell(e,t,s){a(this,o).unmarkCell(e,t,s)}showWinner(e,t){a(this,o).showWinner(e,t)}bindRestartGame(e){a(this,o).bindStartNewGame(e)}bindResetGame(e){a(this,o).bindResetGame(e)}resetBoardUI(){a(this,o).resetVisuals()}startNewGame(){this.resetBoardUI(),a(this,o).hide(),a(this,l).showModal(),a(this,d).showAnimations()}showGame(){a(this,l).hideModal(),a(this,d).hideAnimations(),a(this,o).show()}}o=new WeakMap,d=new WeakMap,l=new WeakMap;class v{constructor(){this.ui=new G,this.board=new b,this.buttonList=document.querySelectorAll(".playgroundButton"),this.boundHandleMove=this.handleMove.bind(this),this.initGame(),this.bindEventListener()}initGame(e=null,t=null){const s={player1:sessionStorage.getItem("player1"),player2:sessionStorage.getItem("player2")};s.player1&&s.player2||e&&t?(this.player1=new p(1,s.player1||e,"donut"),this.player2=new p(10,s.player2||t,"burger"),e&&t&&(sessionStorage.setItem("player1",e),sessionStorage.setItem("player2",t)),this.currentPlayer=this.player1,this.ui.updateTurn(this.currentPlayer.name),this.initButtons(),this.ui.showGame()):this.ui.bindNewGame(this.initGame.bind(this))}bindEventListener(){this.ui.bindRestartGame(this.startNewGame.bind(this)),this.ui.bindResetGame(this.resetGame.bind(this))}handleMove(e,t,s){if(this.board.isCellOccupied(e,t))return;this.ui.markCell(s,this.currentPlayer.cssClass),this.board.updateCell(e,t,this.currentPlayer);const i=this.board.checkWinner();if(i){this.showWinner(i),this.disableButtons();return}if(this.board.round>4){const n=this.board.removeOldest(),h=n.playerId===1?this.player1.cssClass:this.player2.cssClass;this.ui.unmarkCell(n.x,n.y,h)}this.switchPlayer(),this.ui.updateTurn(this.currentPlayer.name)}switchPlayer(){this.currentPlayer=this.currentPlayer===this.player1?this.player2:this.player1}showWinner(e){const t=e===1?this.player1:this.player2,s=e===1?this.player2:this.player1;this.ui.showWinner(t,s)}disableButtons(){this.buttonList.forEach(e=>{e.removeEventListener("click",this.boundHandleMove)})}initButtons(){this.ui.bindMoveHandler(this.boundHandleMove)}resetGame(){this.board.resetBoard(),this.ui.resetBoardUI(),this.currentPlayer=this.player1,this.ui.updateTurn(this.currentPlayer.name),this.initButtons()}startNewGame(){sessionStorage.removeItem("player1"),sessionStorage.removeItem("player2"),this.ui.startNewGame(),this.initButtons()}}document.addEventListener("DOMContentLoaded",()=>{new v});
